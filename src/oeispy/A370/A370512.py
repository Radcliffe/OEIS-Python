# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A370512

from collections import Counter
from operator import itemgetter
from sympy.ntheory.primetest import is_square
from sympy.utilities.iterables import partitions, multiset_permutations
def A370512(n):
    smax, m = 0, 0
    for s, p in sorted(partitions(n,size=True),key=itemgetter(0),reverse=True):
        if s<smax:
            break
        q = tuple(Counter(p).elements())
        c = sum((Counter(str(d)) for d in q), start=Counter())
        if len(tuple(filter(lambda x:x&1,c.values()))) <= 1:
            for a in multiset_permutations(q):
                if (b:=''.join(str(d) for d in a))==b[::-1] and is_square(k:=int(b)):
                    m = max(k,m)
            if m>0:
                smax=s
    return m

