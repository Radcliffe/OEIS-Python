# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A387543

from sympy import primefactors
def a(n):
    if n == 1:
        return 1
    if n % 2 == 0:
        return n // 2
    m = (n - 1) // 2
    pf = primefactors(n)
    p = q = pf[0]
    s = m // p
    best = n // p
    for p in pf[1:]:
        s += (m - s) // p
        q *= p
        best = max(best, s - m // q + n // q)
    return best # _David Radcliffe_, Sep 07 2025

