# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A387064

from sympy import isprime, integer_nthroot
def A387064(n):
    if isprime(n): return n-1
    a, b = integer_nthroot(n,2)
    if b and isprime(a): return n-a
    r, c = [1], n==1
    for m in range(n):
        s = [1]
        for i in range(m):
            s.append((r[i]+r[i+1])%n)
            c += s[-1]==0
        r = s+[1]
        c += (n==1)<<1
    return int(c) # _Chai Wah Wu_, Aug 21 2025

