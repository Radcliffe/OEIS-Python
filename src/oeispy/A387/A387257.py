# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A387257

from math import isqrt
from sympy import integer_nthroot, mobius
from oeis_sequences.OEISsequences import bisection, squarefreepi
def A387257(n):
    def f(x):
        c, l, y = n+x+1, 0, isqrt(x)
        j = isqrt(y)
        while j>1:
            k2 = integer_nthroot(y//j**2,3)[0]+1
            w = squarefreepi(k2-1)
            c -= j*(w-l)
            l, j = w, isqrt(y//k2**3)
        return c+l+sum(mobius(k)*((z:=integer_nthroot(x,k)[0])-1)+(0 if k== 6 else squarefreepi(z))-1 for k in range(3,x.bit_length()))
    return bisection(f,n,n) # _Chai Wah Wu_, Dec 01 2025

