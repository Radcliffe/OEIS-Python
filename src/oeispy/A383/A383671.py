# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A383671

from math import isqrt
def A047924(n): return ((m:=(n+isqrt(5*n**2)>>1)+1)+isqrt(5*m**2)>>1)+m+1
def A026356(n): return (n+1+isqrt(5*(n-1)**2)>>1)+n
def A383671(n):
    def bsearch(f, n):
        kmin, kmax = 0, 1
        while f(kmax) <= n:
            kmax <<= 1
        kmin = kmax>>1
        while True:
            kmid = kmax+kmin>>1
            if f(kmid) > n:
                kmax = kmid
            else:
                kmin = kmid
            if kmax-kmin <= 1:
                break
        return kmin
    if n<3: return n
    for i, f in enumerate((A047924, A026356)):
        if f(bsearch(f,n+1))==n+1: return i
    return 2 # _Chai Wah Wu_, May 21 2025

