# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A385741

from gmpy2 import digits
import re, sympy
from sympy import S, I, sqrt, simplify, Rational
def A385741(n):
    s = digits(n,3)
    n1 = s.count('1')
    n2 = s.count('2')
    n01 = s.count('10')
    n02 = s.count('20')
    n11 = len(re.findall('(?=11)',s))
    n12 = s.count('21')
    n121 = len(re.findall('(?=121)',s))
    n122 = s.count('221')
    n21 = s.count('12')
    n22 = len(re.findall('(?=22)',s))
    x1 = (3*(3**n2*(12*n01+(n02<<4)+3*n11+(n12<<2))-(n01+n12<<2)+(n02<<4)+n11)<<n1)>>3
    beta = S.Half*(I*sqrt(3)-1)
    def ind2(t): return (0,0,1,0,2,5,0,4,3)[t]
    def X(t): return beta**(ind2(t)-n11-n12+n121-n122)*(2-beta)**(n21-n121)*(3+beta)**(n2-n12-n21-n22+n121+n122)
    def Y(t): return beta**(n11-ind2(t))*(1-beta)**(n21-n121)*(2+beta)**(n2-n21-n22)*(1+2*beta)**n121
    def f(t): return ((3**n2<<n1)+((1<<n1) if (t+1)%3 else -(1<<n1))+((-1 if (not (t+1)%3)+n11+n122&1 else 1)<<n1-n11+n122+1)*sympy.re(X(t))+((not n122)*(-1 if n11&1 else 1)*3**(n22-n122)<<n1-n11+1)*sympy.re(Y(t)))*Rational(1,6)
    x2 = simplify(sum(i*f(i) for i in (1,2,4,5,7,8)))
    return int(x1+x2)

