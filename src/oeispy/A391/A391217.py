# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A391217

from mpmath import iv
from math import ceil
log2 = iv.log(2)
def iv_ceil(x):
    a, b = ceil(x.a), ceil(x.b)
    if a!=b: raise ValueError
    return a
def sample_gauss_kuzmin_distribution(n):
    k, p_sum, seq = 1, 0, [0] * n
    zero_idx = list(range(n))
    while zero_idx:
        pk = -iv.log(1-1/((k+1)*(k+1))) / log2
        p_cond = pk / (1 - p_sum)
        new_zero_idx = []
        for i, seq_i in enumerate(zero_idx, start=1):
            val = int(iv_ceil(i*p_cond) - iv_ceil((i-1)*p_cond))
            if val: seq[seq_i] = k
            else: new_zero_idx.append(seq_i)
        zero_idx = new_zero_idx
        p_sum += pk
        k += 1
    return seq
A391217 = sample_gauss_kuzmin_distribution(101)

