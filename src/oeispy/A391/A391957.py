# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A391957

from sympy import prime
def Sum(n,p):
    s = 0
    while n > 0: s, n = s+n, n//p
    return s
def PrimePower(p,e):
    if e == 0: return 0
    else: return p*PrimePower(p,e-1) + 2*p**e - 1
def A391957(n,m):
    p, d = prime(m), []
    while n > 0: d, n = [n%p]+d, n//p
    L = len(d)-1
    a, k, ns = d[0]*PrimePower(p,L), 0, 0
    while k < L:
        ns, k = ns*p+d[k], k+1
        if d[k] > 0: a = a + d[k]*(PrimePower(p,L-k)-2*p**(L-k)*Sum(ns,p))
    return a

