# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A384631

# From Proposition 4.2 in the reference:
from sympy import divisors, factorial, totient
def A384631(n):
    s = 0
    if n%2==0:
        for d in divisors(n//2):
            if d%2==0:
                s += totient(d)*factorial(n//d)*(d//2)**(n//2//d)//factorial(n//2//d)
            else:
                s += totient(d)*sum(factorial(n//d)*d**i//2**i//factorial(i)//factorial(n//d-2*i) for i in range(n//2//d+1))
        s += n//2*((n%4)//2+1)*factorial(2*(n//4))//factorial(n//4)
    else:
        for d in divisors(n):
            s += totient(d)*sum(factorial(n//d)*d**i//2**i//factorial(i)//factorial(n//d-2*i) for i in range(n//d//2+1))
        if n%4==1:
            s += n*factorial(n//2)//factorial(n//4)
    return s//n//2

