# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A384940

from math import isqrt
from sympy import primepi, primerange, prime
def A384940(n):
    if n&1:
        m = n+1>>1
        def bisection(f,kmin=0,kmax=1):
            while f(kmax) > kmax: kmax <<= 1
            kmin = kmax >> 1
            while kmax-kmin > 1:
                kmid = kmax+kmin>>1
                if f(kmid) <= kmid:
                    kmax = kmid
                else:
                    kmin = kmid
            return kmax
        def f(x): return int(m+x+((t:=primepi(s:=isqrt(x)))*(t-1)>>1)-sum(primepi(x//k) for k in primerange(3, s+1)))
        return bisection(f,m,m)
    else:
        return prime(n>>1)<<1 # _Chai Wah Wu_, Jun 17 2025

