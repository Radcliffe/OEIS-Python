# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A096336

import numpy as np
def a_typical(n):
    '''
    For most n, this is the value of a(n)
    '''
    return int(n - np.floor(np.log2( n*(n+1)/2 + 1)))
def a(n):
    '''
    The torsion index of Spin_{2n+1} and Spin_{2n+2} is 2^a(n)
    Totaro denotes it by u(ell)
    '''
    if n >= 0 and n <= 18:   # Table 1 in Totaro's paper
        return [0,0,0,1,1,1,2,3,4,4,5,5,6,7,8,9,10,10,11][n];
    maxe = int(np.floor(np.log2(n)))
    for e in range(maxe+1):
        b = n - 2**e
        if 2*b - a(b) <= e - 3: # occurs for n = 8, 16, 32, 33, ...
            return a_typical(n)+1
    return a_typical(n)
# _Skip Garibaldi_, Mar 05 2017

