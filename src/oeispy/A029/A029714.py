# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A029714

from itertools import count
from sympy import multiplicity
def A029714(n):
    a, m, c = 0,0,0
    for k in count(1):
        c += multiplicity(3,k)
        if c+k>=m:
            a+=k*(min(c+k-m,n-m)+1)
            m = c+k+1
        if c+k >= n:
            return 3*a-2 # _Chai Wah Wu_, Feb 24 2026

