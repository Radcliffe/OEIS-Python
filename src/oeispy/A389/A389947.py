# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A389947

from math import isqrt
from sympy import integer_nthroot
from oeis_sequences.OEISsequences import bisection, squarefreepi
def A389947(n):
    def f(x):
        c, l, y = n+x-1, 0, isqrt(x)
        j = isqrt(y)
        while j>1:
            k2 = integer_nthroot(y//j**2,3)[0]+1
            w = squarefreepi(k2-1)
            c += j*(w-l)
            l, j = w, isqrt(y//k2**3)
        return c-y-l+squarefreepi(integer_nthroot(y,3)[0])+squarefreepi(y)
    return bisection(f,n,n) # _Chai Wah Wu_, Dec 01 2025

