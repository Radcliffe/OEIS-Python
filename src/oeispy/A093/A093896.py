# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A093896

from itertools import count
from sympy import factorint, multiplicity
def A093896(n):
    m = 1
    for p, e in factorint(n).items():
        g = e*n
        if g<=p:
            m = max(m,g*p)
        else:
            c, a = 0, max(p,(g*(p-1)//p**2)*p)
            b = a-p
            while b>0:
                c += (b:=b//p)
            for k in count(a,p):
                c += multiplicity(p,k) if p>2 else (~k&k-1).bit_length()
                if c+k+p > g:
                    m = max(m, p*(max(k,g-c) if g>=p else g+1-c))
                    break
    return m # _Chai Wah Wu_, Feb 26 2026

