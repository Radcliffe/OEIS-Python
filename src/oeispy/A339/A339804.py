# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A339804

from math import isqrt
def A339804(n): return (n*(1-n**2)+((s:=isqrt(n))**4<<1)+s**3*(3*(1-n))+s**2*(1-3*n) + sum((q:=n//k)*(-6*k**2+n*(3*((k<<1)+q+1))-q*((q<<1)+3)-1) for k in range(1,s+1)))//6 # _Chai Wah Wu_, Oct 27 2023

