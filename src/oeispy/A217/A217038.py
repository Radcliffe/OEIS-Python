# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A217038

from math import isqrt
from sympy import mobius, integer_nthroot
def A217038(n):
    def squarefreepi(n): return int(sum(mobius(k)*(n//k**2) for k in range(1, isqrt(n)+1)))
    c, l = 0, 0
    j = isqrt(n-1)
    while j>1:
        k2 = integer_nthroot((n-1)//j**2,3)[0]+1
        w = squarefreepi(k2-1)
        c += j*(w-l)
        l, j = w, isqrt((n-1)//k2**3)
    c += squarefreepi(integer_nthroot(n-1,3)[0])-l
    return c # _Chai Wah Wu_, Sep 12 2024

