# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A380431

from math import isqrt
from sympy import mobius, integer_nthroot, primepi
def A380431(n):
    def squarefreepi(n): return int(sum(mobius(k)*(n//k**2) for k in range(1, isqrt(n)+1)))
    l, m = 0, 1<<n
    c, j = -1-sum(primepi(integer_nthroot(m, k)[0]) for k in range(2, m.bit_length()))+squarefreepi(integer_nthroot(m,3)[0]), isqrt(m)
    while j>1:
        k2 = integer_nthroot(m//j**2,3)[0]+1
        w = squarefreepi(k2-1)
        c += j*(w-l)
        l, j = w, isqrt(m//k2**3)
    return c-l # _Chai Wah Wu_, Jan 30 2025

