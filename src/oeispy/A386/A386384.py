# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A386384

import sys #for printing huge factorials
sys.set_int_max_str_digits(0)  # otherwise sys not needed.
def a386384(n):
    import math
    if n==0: return 0
    t=n-1; M=0x18199818
    s=[1,1]; h=2; p=0; r=0
    def g(u):
        nonlocal s,h
        while len(s)<u:
            q=2 if (h&1)==0 else 1
            s+= [q]*((s[h-1]*2)//q); h+=1
    while True:
        g(p+2)
        if s[p]==2: xb='B'; p+=1
        elif p+1<len(s) and s[p]==1 and s[p+1]==1: xb='A'; p+=2
        else: g(p+2); continue
        yb = xb if ((M>>(r&31))&1) else ('A' if xb=='B' else 'B')
        L = 2 if yb=='A' else 1
        if t < L: return 1 if yb=='A' else 2
        t -= L
        if t==0:
            rr=r+1
            K=((rr & -rr).bit_length()-1)+2
            A=math.factorial(math.factorial(K+1))
            B=math.factorial(math.factorial(K))
            return A//(B*B)-1
        t-=1; r+=1

