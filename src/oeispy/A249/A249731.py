# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A249731

import re
from gmpy2 import digits
def A249731(n):
    s = digits(n,3)
    n1 = s.count('1')
    n2 = s.count('2')
    n01 = s.count('10')
    n02 = s.count('20')
    n11 = len(re.findall('(?=11)',s))
    n12 = s.count('21')
    return (((3*(n01+1)+(n02<<2)+n12<<2)+3*n11)*(3**n2<<n1)//12)-(2+((n>>1)&~n).bit_count()<<n.bit_count()>>1) # _Chai Wah Wu_, Jul 24 2025

