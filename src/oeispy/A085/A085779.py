# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A085779

from itertools import count
from collections import Counter
from sympy import factorint, multiplicity
def A085779(n):
    m = 1
    f = Counter(factorint(n))+Counter(factorint(n+1))
    f[2] -= 1
    for p, e in f.items():
        if e<=p:
            m = max(m,e*p)
        else:
            c, a = 0, max(p,(e*(p-1)//p**2)*p)
            b = a-p
            while b>0:
                c += (b:=b//p)
            for k in count(a,p):
                c += multiplicity(p,k) if p>2 else (~k&k-1).bit_length()
                if c+k+p > e:
                    m = max(m, p*(max(k,e-c) if e>=p else e+1-c))
                    break
    return m # _Chai Wah Wu_, Feb 26 2026

