# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A267077

from math import sqrt
def A267077(n):
    if n == 0:
        return 1
    u,v,t,w = max(8,2*n),max(4,n)**2-9,4*n*(n+1),n**2
    while True:
        m,r = divmod(v,t)
        if not r and int(sqrt(m*w+1))**2 == m*w+1:
            return m
        v += u+1
        u += 2 # _Chai Wah Wu_, Jan 15 2016
#!/usr/bin/python3
# This sequence is easy if you use a Pell-equation solver such as labmath.py
# Solve the A267077 Pell equation:
# nx^2 - (4n+4)y^2 = 5n-4; but also y^2 == 1 mod n^2
# Let u = nx, then # u^2 - n*(4n+4)y^2 = n*(5n-4)
#   and (y > n) and (u == 0 mod n) and (y^2 == 1 mod n^2)
# (y > n makes m > 0)
# Report m = (y^2 - 1) / n^2
import labmath
print(0, 1)
print(1, 35) # When n<2, the Pell equation is elliptical.
for nn in range(2,1001):
    nsq = nn * nn
    ps = labmath.pell(nn*(4*nn+4), nn*(5*nn-4))
    uu,yy = next(ps[0])
    while (yy <= nn) or ((uu % nn) != 0) or ((yy*yy) % nsq != 1):
        uu,yy = next(ps[0])
    print(nn, (yy*yy - 1) // nsq)
# From _Don Reble_, Apr 15 2022, added by _N. J. A. Sloane_, Apr 15 2022.

