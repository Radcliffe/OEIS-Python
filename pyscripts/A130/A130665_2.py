# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A130665

def a(n):  # formula version, n=10^10000 takes ~1 second
    if n == 0:
        return 1
    msb = 1 << (n.bit_length() - 1)
    return msb**2 + 3 * a(n-msb) # _Stefan Pochmann_, Mar 15 2023
def a(n):  # optimized, n=10^50000 takes ~1 second
    n += 1
    total = 0
    power3 = 1
    while n:
        log = n.bit_length() - 1
        total += power3 << (2*log)
        n -= 1 << log
        power3 *= 3
    return total # _Stefan Pochmann_, Mar 15 2023

