# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A354408

from sympy import Matrix
def A354408(n,k):
    return Matrix(n,n,lambda i,j:int(i!=j and i!=(j+k)%n)).per() # _Pontus von Brömssen_, May 31 2022
# This version, based on the formula in A277256, is much faster than the version using permanents, at least for large n.
from sympy import factorial,gcd,sqrt
from sympy.abc import z
def A354408(n,k):
    k=gcd(n,k)
    F=((1-sqrt(1+4*z))/2)**(2*(n//k))+((1+sqrt(1+4*z))/2)**(2*(n//k))
    p=(F**k).series(z,0,n+1)
    return sum((-1)**j*factorial(n-j)*p.coeff(z,j) for j in range(n+1)) # _Pontus von Brömssen_, Jun 02 2022

