# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A180622

# faster program
from functools import lru_cache
from sympy import primepi
def A180622(n):
    @lru_cache(maxsize=None)
    def f(n): # based on second formula in A018805
        if n == 0:
            return 0
        c, j = 0, 2
        k1 = n//j
        while k1 > 1:
            j2 = n//k1 + 1
            c += (j2-j)*(f(k1)-1)
            j, k1 = j2, n//j2
        return (n*(n-1)-c+j)
    return len({i*j for i in range(1,n+1) for j in range(1,i+1)})+f(n)+primepi(n<<1)-primepi(n)-n # _Chai Wah Wu_, Aug 21 2024

