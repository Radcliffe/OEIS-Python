# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A289676

from __future__ import division
def A289676(n):
    c, k, r, n2, cs, ts = 0, 1+(n-1)//3, 2**((n-1) % 3), 2**(n-1), set(), set()
    for i in range(2**k):
        j, l = int(bin(i)[2:],8)*r, n2
        traj = set([(l,j)])
        while True:
            if j >= l:
                j = j*16+13
                l *= 2
            else:
                j *= 4
                l //= 2
            if l == 0:
                c += 1
                ts |= traj
                break
            j %= 2*l
            if (l,j) in traj:
                cs |= traj
                break
            if (l,j) in cs:
                break
            if (l,j) in ts:
                c += 1
                break
            traj.add((l,j))
    return c # _Chai Wah Wu_, Aug 03 2017

