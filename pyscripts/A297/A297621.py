# This file is auto-generated from OEIS data.
# Please do not edit this file directly.
# OEIS sequence: A297621

from math import log
def exp_fit(n, a, b):
    k = int(log(n, 2))
    return 3 * (a[k] * (2 ** (n + 1)) - b[k])
def S(n):
    if n == 0:
        return 1
    k = int(log(n, 2))
    a = [0]
    b = [-1]
    for i in range(1,k + 1):
        S_0 = exp_fit(i, a, b)
        S_1 = exp_fit(2 ** i - 1, a, b)
        a.append(S_0 / 3)
        b.append(((2 ** 2 ** i) * S_0 - S_1) / 3)
    return exp_fit(n, a, b)

